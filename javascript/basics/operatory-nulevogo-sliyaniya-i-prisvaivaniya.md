---
description: Новые возможности в языке
---

# Операторы нулевого слияния и присваивания "??", "??="

## Оператор нулевого слияния `??`

{% hint style="danger" %}
**Новая возможность**

Эта возможность была добавлена в язык недавно. В старых браузерах может понадобиться полифил.
{% endhint %}

Этот оператор обрабатывает `null` и `undefined` одинаковым образом.

Как работает:

* Если первый операнд `a` определён (не null и не undefined), то результат будет `a`.
* Если операнд `a` не определён (null или undefined), то результатом будет `b`.

```javascript
let a = "Текст";
let b = null;

result = a ?? b;
console.log(result)
```

Это то же самое, что и:

```javascript
let a = "Результат";
let b = null;

result = (a !== null && b !== undefined) ? a : b;
console.log(result) // Результат
```

Этот оператор нужен для того, чтобы задать значение по умолчанию потенциально неопределённой переменной.

```javascript
let a;
console.log(a ?? "Неопределённая переменная") // Неопределённая переменная
```

Можно записать последовательность из операторов для того, чтобы получить первое значение из списка, которое не является `null/undefined`.&#x20;

Допустим, у нас есть данные пользователя в переменных `firstName`, `lastName` или `nickName`. Все они могут не существовать, если пользователь решил не вводить соответствующие значение.

Мы хотели бы отобразить имя пользователя, используя одну из этих переменных, или показать «Аноним», если все они `null/undefined`.

```javascript
let firstName = null;
let lastName = null;
let nickName = "Суперкодер";

// показывает первое значение, которое определено:
alert(firstName ?? lastName ?? nickName ?? "Аноним"); // Суперкодер
```

Конечно можно использовать оператор `||` (ИЛИ), но этот оператор не различает `false`, `0`, пустую строку `""` и `null/undefined`. Для него они все одинаковы, т.е. являются ложными значениями.

{% hint style="info" %}
Оператор `??` имеет очень низкий приоритет, лишь немного выше, чем у `?` и `=`, поэтому при использовании его в выражении, скорее всего, потребуются скобки.&#x20;

Приоритет оператора `??` такой же, как и у `||`.
{% endhint %}

Это означает, что, как и `||`, оператор нулевого слияния `??` вычисляется до `=` и `?`, но после большинства других операций, таких как `+`, `*`.

Так что, в выражениях такого вида понадобятся скобки:

```javascript
let height = null;
let width = null;

// важно: используйте круглые скобки
let area = (height ?? 100) * (width ?? 50);

alert(area); // 5000
```

{% hint style="warning" %}
По соображениям безопасности JavaScript запрещает использование оператора `??` вместе с `&&` и `||`, если приоритет явно не указан при помощи круглых скобок. Используйте скобки, чтобы обойти это ограничение.
{% endhint %}

```javascript
let x = 1 && 2 ?? 3; // Синтаксическая ошибка
let y = (1 && 2) ?? 3; // 2
```

## Оператор нулевого присваивания `??=`

Предположим, нам необходимо проверить, равна ли переменная `null` или `undefined`, и если это так — присвоить этой переменной какое-либо другое значение. Если значение `x` не равно `null`/`undefined`, то выражение справа никогда не выполнится. В противном случае `"Аноним"` присвоится переменной `x`.

```javascript
let x
x ??= "Аноним"

console.log(x) // Аноним
```

Оператор `??=` присвоит `x` значение `y` только в том случае, если `x` не определено (`null`/`undefined`).
