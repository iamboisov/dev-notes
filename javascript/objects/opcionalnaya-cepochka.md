---
description: >-
  Новая возможность JavaScript, которая дает доступ к свойствам вложенных
  объектов, даже если какие-то из промежуточных свойств не существуют.
---

# Опциональная цепочка

## Проблема несуществующего свойства

Пример:

Предположим у нас есть объекты `user`, которые содержат информацию о пользователях. У большинства пользователей есть адреса в свойстве `user.address` с улицей `user.address.street`, но некоторые пользователи не указали их.

В таком случае, если пользователь не указал свой адрес, при попытке получить доступ к свойству мы получим ошибку `undefined`.

Конечно, для того чтобы решить эта проблему можно использовать проверку с помощью `if` или `?`, логический оператор `&&`, но такой код может быстро стать нечитабельным в случае, если глубина свойств объекта большая.

{% code overflow="wrap" %}
```javascript
let user = {}; // у пользователя нет адреса

// Такой код сложно читать
console.log(user.address ? user.address.street ? user.address.street.name : null : null);

// Этот код читать уже легче, но цепочка довольно длинная
console.log(user.address && user.address.street && user.address.street.name)
```
{% endcode %}

## Опциональная цепочка

Поэтому на помощь приходит опциональная цепочка.

```javascript
let user = {
  address: {
    city: "Moscow",
    street: "Pantel",
  }
};

// Код компактный и понятный
console.log( user?.address?.street ); // Pantel
```

Опциональная цепочка `?.` останавливает вычисление и возвращает `undefined`, если значение перед `?.` равно `undefined` или `null`.

Синтаксис `?.` делает необязательным значение перед ним, но не какое-либо последующее.

{% hint style="warning" %}
Не злоупотребляйте опциональной цепочкой!

Синтаксис `?.` необходимо использовать только тогда, когда чего-то не существует. В противном случае можно наделать ошибок и не найти где косяк.
{% endhint %}

Например если мы знаем, что объект `user` существует, а `address` возможно нет, то надо писать:

```javascript
user.address?.street
```

## Сокращенное вычисление

{% code overflow="wrap" %}
```javascript
let user = {
  sayHi(number) {
    console.log(number)
  }
};

let x = 0;

user?.sayHi(++x) // В данном примере объект user существует, поэтому производится сокращенное вычисление
```
{% endcode %}

## Другие варианты использования

Опциональная цепочка также может быть использована с функция и свойствами объекта. Предположим мы не знаем существует ли метод `sayHi()`. Поэтому ставим точку перед круглыми скобками.

Например:

```javascript
let user = {
  sayHi() {
    console.log("Привет")
  }
};

let admin = {};

user.sayHi?.() // Результат: Привет
admin.sayHi?.() // Ничего не выведется
```

А теперь с объектами:

```javascript
let user = {
  address: {
    city: "Moscow",
    street: "Pantel",
  }
};

let admin = {};

console.log(user.address?.["street"]) // Работает также как и с точкой без []
```

Также можно использовать с `delete`, если объект или свойство существует.

```javascript
delete user?.address
```

{% hint style="warning" %}
Опциональную цепочку можно использовать для безопасного чтения и удаления, но не для записи
{% endhint %}

Пример:

```javascript
let user = null;

user?.name = "John"; // Это то же самое, что и undefined = "John"
```
